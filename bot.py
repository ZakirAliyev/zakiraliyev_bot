import sqlite3
from telegram import Update, ReplyKeyboardMarkup, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, CallbackContext, CallbackQueryHandler

# Bot tokeni
TOKEN = '7505093385:AAEGwLI1AJOjukHTnKfkWgUj6MIOMKewOOo'

# SQLite veril…ônl…ôr bazasƒ±na qo≈üulma v…ô c…ôdv…ôl yaratma
conn = sqlite3.connect('orders.db')
c = conn.cursor()
c.execute('''CREATE TABLE IF NOT EXISTS deleted_orders (id INTEGER PRIMARY KEY, order_detail TEXT)''')
conn.commit()


# ∆èsas menyu funksiyasƒ±
async def start(update: Update, context: CallbackContext) -> None:
    welcome_message = (
        "–ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –£–º–∞–º–∏üç£ü•¢, –∏ —è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é —É—Å–ª—É–≥—É –¥–æ—Å—Ç–∞–≤–∫–∏ –µ–¥—ã.\n\n"
        "–ü—Ä–æ—Å—Ç–æ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –≤ –º–µ–Ω—é –∏ —Å–¥–µ–ª–∞–π—Ç–µ –∑–∞–∫–∞–∑ –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç–µ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é..\n\n"
        "–ù–∞—à–∞ —Å–ª—É–∂–±–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –µ–¥—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±—ã—Å—Ç—Ä—ã–µ, —É–¥–æ–±–Ω—ã–µ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–ª—é–¥–∞. "
        "–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–∫–∞–∑–∞—Ç—å –µ–¥—É –∏–∑ –±–ª–∏–∂–∞–π—à–∏—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –∏ –º—ã –¥–æ—Å—Ç–∞–≤–∏–º –µ—ë –ø—Ä—è–º–æ –∫ –≤–∞–º –¥–æ–º–æ–πüöó."
    )
    keyboard = [['üç£–ú–µ–Ω—é', 'üí¨ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'], ['üéâ–ê–∫—Ü–∏–∏', 'üìû–ö–æ–Ω—Ç–∞–∫—Ç—ã'], ['üë©‚Äçüíª–í–µ–±-—Å–∞–π—Ç', 'üóë–ö–æ—Ä–∑–∏–Ω–∞']]
    reply_markup = ReplyKeyboardMarkup(keyboard, resize_keyboard=True)
    await update.message.reply_text(welcome_message, reply_markup=reply_markup)


# Men√º funksiyasƒ±
async def menu(update: Update, context: CallbackContext) -> None:
    keyboard = [
        [InlineKeyboardButton("–•–æ—Å–æ–º–∞–∫–∏ –∏ –§—É—Ç–æ–º–∞–∫–∏ —Ä–æ–ª–ª—ã üç£", callback_data='sushi')],
        [InlineKeyboardButton("–£—Ä–∞–º–∞–∫–∏ —Ä–æ–ª–ª—å üç±", callback_data='rolls')],
        [InlineKeyboardButton("–ó–∞–ø–µ—á—ë–Ω–Ω—ã–µ —Ä–æ–ª–ª—ã üçú", callback_data='soups')],
        [InlineKeyboardButton("–¢–µ–º–ø—É—Ä—ã —Ä–æ–ª–ª—ã üç∞", callback_data='desserts')],
        [InlineKeyboardButton("–ù–∏–≥–∏—Ä–∏ –∏ –ì—é–Ω–∫–∞–Ω üç£", callback_data='nigiri')],
        [InlineKeyboardButton("–ó–∞–∫—É—Å–∫–∏ –∏ —Å–∞–ª–∞—Ç—ã üç±", callback_data='snacks')],
        [InlineKeyboardButton("–ú–µ–Ω—é üç£", callback_data='menu')],
        [InlineKeyboardButton("–°—É–ø—å –∏ Wok üçú", callback_data='wok')],
        [InlineKeyboardButton("–°–∞—à–∏–º–∏ üç£", callback_data='sashimi')],
        [InlineKeyboardButton("–†–æ–ª–ª—ã –æ—Ç —à–µ—Ñ–∞ üç£", callback_data='chef')],
        [InlineKeyboardButton("–°–µ—Ç—å üåê", callback_data='network')],
        [InlineKeyboardButton("–î–æ–±–∞–≤–∫–∏ üç∂", callback_data='additives')],
        [InlineKeyboardButton("–ù–∞–ø–∏—Ç–∫–∏ üçπ", callback_data='drinks')]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    # update.message kontrol√º
    if update.message:
        await update.message.reply_text("üç± Men√º", reply_markup=reply_markup)
    elif update.callback_query:
        # Callback query durumunu ele al
        await update.callback_query.message.reply_text("üç± Men√º", reply_markup=reply_markup)


async def button(update: Update, context: CallbackContext) -> None:
    query = update.callback_query
    await query.answer()  # Callback query cavablandƒ±rƒ±lƒ±r

    if query.data == 'add_to_cart':
        await query.edit_message_text(text="Se√ßdiyiniz m…ôhsul s…ôb…ôt…ô …ôlav…ô edildi!")
    elif query.data == 'back_to_menu':
        await query.edit_message_text(text="üç± Men√º…ô geri qayƒ±tdƒ±nƒ±z.")
        await menu(update, context)
    elif query.data == 'select_quantity':
        await query.edit_message_text(text="Ne√ß…ô …ôd…ôd se√ßm…ôk ist…ôyirsiniz? (M…ôs…ôl…ôn, '3' yazƒ±n)")
    elif query.data == 'sushi':
        await query.edit_message_text(text="–•–æ—Å–æ–º–∞–∫–∏ –∏ –§—É—Ç–æ–º–∞–∫–∏ —Ä–æ–ª–ª—ã üç£\n\n")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/8480c47be00d9619e71abd2b38c5ffbca62b7dc800410dc3e3e69a425724ce0c/6771c2c9/cAv90-koGPMID3856T0QhhTZlioVJaUiwhAAerDWHL9VGchhYPVbZoPzQAeOWTvxk9kh9SqB5rxLb-vV5hICHw%3D%3D?uid=0&filename=DSC_1047.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="–•–æ—Å–æ–º–∞–∫–∏ –∏ –§—É—Ç–æ–º–∞–∫–∏ —Ä–æ–ª–ª—ã")
        await show_options(query)
    elif query.data == 'rolls':
        await query.edit_message_text(text="–£—Ä–∞–º–∞–∫–∏ —Ä–æ–ª–ª—å üç±\n\n")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/6cc362e869f69f8b06e3d72eef519a449fcf74e65120132d9cfeaf8611409cc2/6771c2c9/1I4yTB6YPHZQiKrAkswmFBTZlioVJaUiwhAAerDWHL8sTF8XK7D3pkgZvre2R7zZAnGrfCIzvlasdbdYWYOa-A%3D%3D?uid=0&filename=DSC_1063.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="–£—Ä–∞–º–∞–∫–∏ —Ä–æ–ª–ª—å")
        await show_options(query)
    elif query.data == 'soups':
        await query.edit_message_text(text="–ó–∞–ø–µ—á—ë–Ω–Ω—ã–µ —Ä–æ–ª–ª—ã üçú\n\n")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/18820cee9fc85552285d45d118f28b2a11f99b2c9ff44e6e9719d4761f999543/6771c2c9/S3EoL1W3CeQYleTBF2rmwRTZlioVJaUiwhAAerDWHL_nNf3b5l8pzLN1HDwj1rl3h8EEdfl6pjvDb7qsGTdnEQ%3D%3D?uid=0&filename=DSC_1073.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="Sobada bi≈üiril…ôn rollar")
        await show_options(query)
    elif query.data == 'desserts':
        await query.edit_message_text(text="–¢–µ–º–ø—É—Ä—ã —Ä–æ–ª–ª—ã üç∞\n\n –¢–µ–º–ø—É—Ä—ã —Ä–æ–ª–ª—ã")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/3177f79ea24ba3d8ff1e20bbc2caf7a298443c5e3a868ac7ff0a6d19c3c9e43a/6771c2c9/wQkxdlyxuOAk1iRI8mHwqAQ3bLLkLcowMCVK5fKH1SLY9il2soV39_Eg0X6oqlnZZgJiseSSSm4bMdFnGc9QjA%3D%3D?uid=0&filename=DSC_1093.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="Tempura rollarƒ±")
        await show_options(query)
    elif query.data == 'nigiri':
        await query.edit_message_text(text="–ù–∏–≥–∏—Ä–∏ –∏ –ì—é–Ω–∫–∞–Ω üç£\n\nM…ôlumat: Nigiri v…ô Gyunkan su≈üi.")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/06a1834fa2076a09390d1b0b4f1f84b27bba10a0d4bbf9e1d34a3844c561635f/6776ccc2/SP-v__kLpMBpYlRwWlNJu3nLercz3c6NzttiCMlPcl5liHfJYSwv5eLpKCO1awHjW73S3WiXikirCQccoQR4Wg%3D%3D?uid=0&filename=DSC_1102.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="Nigiri v…ô Gyunkan su≈üisi")
        await show_options(query)
    elif query.data == 'snacks':
        await query.edit_message_text(text="–ó–∞–∫—É—Å–∫–∏ –∏ —Å–∞–ª–∞—Ç—ã üç±\n\nM…ôlumat: √áe≈üidli salatlar v…ô q…ôlyanaltƒ±lar.")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/c57835db64109cb6d51605872f90408b91f814f3552b458ef6758a9f8e41b1be/6776ccc2/Ft11foOPDgv8XG4rxJOATLIVP1pqSSvN906Vqepk3fkrCdP8-XYJR80o4l-kEmURMQYRewcF2q6pxm0g9uJ1dQ%3D%3D?uid=0&filename=DSC_1105.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="√áe≈üidli salatlar v…ô q…ôlyanaltƒ±lar")
        await show_options(query)
    elif query.data == 'wok':
        await query.edit_message_text(text="–°—É–ø—å –∏ Wok üçú\n\nM…ôlumat: Wok yem…ôkl…ôri v…ô ≈üorbalar.")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/48f351d4f94dddd87a04ceb85b712e3d93d1b98ac33ad0cb785b8d9bf2744622/6776ccc2/Yk1AZQW8Aph5_BPJM1jw62jlziapQVenX953dkt2WHiGhsbmXO4ioO7qHTUfKYn4QleoYNO-kKHsKtk_lSL5sQ%3D%3D?uid=0&filename=DSC_1116.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="Wok yem…ôkl…ôri")
        await show_options(query)
    elif query.data == 'sashimi':
        await query.edit_message_text(text="–°–∞—à–∏–º–∏ üç£\n\nM…ôlumat: Xam balƒ±q par√ßalarƒ±.")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/ebf45e13a8499b950fd2ed4b913e3f600132561137a1c433d09428914662b936/6776ccc2/yU_F0bsM5sbF5P246MktOMjAKhgJDBTganDisG8lC9Oa4ipZtTR1Yrgdy7muK_1XfHOD7KZWybhqFadSeerEjw%3D%3D?uid=0&filename=DSC_1121.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="Xam balƒ±q par√ßalarƒ±")
        await show_options(query)
    elif query.data == 'chef':
        await query.edit_message_text(text="–†–æ–ª–ª—ã –æ—Ç —à–µ—Ñ–∞ üç£\n\nM…ôlumat: ≈ûefin √∂z…ôl rolu.")
        await query.message.reply_photo(
            photo="https://downloader.disk.yandex.ru/preview/4e1689535768e67b3786f8264c385ddc97e442a44d661e8cc02c1ee01079d30e/6776ccc2/TBlwpAtm7alYj9gzlCuzlUHqybfg6rPlekc58m1K5Q7i5Au4AXV9Vob6zQVlw1vIQqy9y99803C_4O1x_Ryn5Q%3D%3D?uid=0&filename=DSC_1124.jpg&disposition=inline&hash=&limit=0&content_type=image%2Fjpeg&owner_uid=0&tknv=v2&size=1898x912",
            caption="≈ûefin √∂z…ôl rolu")
        await show_options(query)
    elif query.data == 'network':
        await query.edit_message_text(text="–°–µ—Ç—å üåê")
        await show_options(query)
    elif query.data == 'additives':
        await query.edit_message_text(text="–î–æ–±–∞–≤–∫–∏ üç∂\n\nM…ôlumat: ∆èlav…ô m…ôhsullar.")
        await show_options(query)
    elif query.data == 'drinks':
        await query.edit_message_text(text="–ù–∞–ø–∏—Ç–∫–∏ üçπ\n\nM…ôlumat: ƒ∞√ßkil…ôr.")
        await show_options(query)


async def show_options(query):
    keyboard = [
        [InlineKeyboardButton("–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É üõí", callback_data='add_to_cart')],
        [InlineKeyboardButton("–ù–∞–∑–∞–¥ üîô", callback_data='back_to_menu')],
        [InlineKeyboardButton("–í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ üßÆ", callback_data='select_quantity')]

    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.message.reply_text("–í—ã–≥–ª—è–¥–∏—Ç –≤–∫—É—Å–Ω–æ üç£", reply_markup=reply_markup)

#
# async def options_button(update: Update, context: CallbackContext) -> None:
#     query = update.callback_query
#     await query.answer()




# ƒ∞stifad…ô√ßi m√º…ôyy…ôn …ôd…ôd se√ßdiyi zaman
async def select_quantity(update: Update, context: CallbackContext) -> None:
    user_input = update.message.text
    try:
        quantity = int(user_input)
        await update.message.reply_text(f"{quantity} …ôd…ôd se√ßdiniz.")
    except ValueError:
        await update.message.reply_text("Xahi≈ü edir…ôm, d√ºzg√ºn bir …ôd…ôd daxil edin.")


# ∆èlaq…ô m…ôlumatlarƒ± funksiyasƒ±
async def contact_info(update: Update, context: CallbackContext) -> None:
    contact_message = (
        "üìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n\n"
        "‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω:+7 929 033 66 99\n"
        "‚úÖ Email: info@company.com\n"
        "‚úÖ –ê–¥—Ä–µ—Å: –ë–æ—Ä–∏—Å–æ–≥–ª–µ–±—Å–∫–∞—è 58 –ê\n\n"
        "–ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã –≤–∞–º –ø–æ–º–æ—á—å!"
    )
    await update.message.reply_text(contact_message)


# ƒ∞nformasiya funksiyasƒ±
async def info(update: Update, context: CallbackContext) -> None:
    info_message = (
        "üìç –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ:\n\n"
        "‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ: –£–º–∞–º–∏ –°—É—à–∏ üç£\n"
        "‚úÖ –£—Å–ª—É–≥–∏: –ë—ã—Å—Ç—Ä–∞—è –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã.\n"
        "‚úÖ –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏:\n"
        "  ‚Ä¢ –ø–Ω-—á—Ç, –≤—Å : 12:00 - 23:00\n"
        "  ‚Ä¢ –ø—Ç, —Å–±: 12:00 - 01:00\n\n"
        "‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞:\n"
        "  ‚Ä¢ –û–±–Ω–∏–Ω—Å–∫: 1000 —Ä.\n"
        "  ‚Ä¢ –ö—Ä–∏–≤—Å–∫–æ–µ, –≠–∫–æ–¥–æ–ª—å–µ, –ë–µ–ª–∫–∏–Ω–æ, –ë–æ—Ä–∏—Å–æ–≥–ª–µ–±—Å–∫–∞—è, –ö–∞–±–∏—Ü—ã–Ω–æ: 1500 —Ä.\n"
        "üõµ –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –Ω–∞—à–∏–º –º–µ–Ω—é."
    )
    await update.message.reply_text(info_message)


# Akciya funksiyasƒ±
async def discounts(update: Update, context: CallbackContext) -> None:
    image_url = 'https://r.resimlink.com/7Qf_XzqGF.jpg'  # ∆èsl ≈ü…ôkil URL-i il…ô …ôv…ôz edin
    await update.message.reply_photo(photo=image_url, caption="üéâ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞–∫—Ü–∏–∏! –ù–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ!")


# Veb-saytƒ± g√∂nd…ôrm…ô funksiyasƒ±
async def website(update: Update, context: CallbackContext) -> None:
    website_url = 'https://umami.com.ru/'  # ∆èsl sayt URL-i il…ô …ôv…ôz edin
    await update.message.reply_text(f"üë©‚Äçüíª –ù–∞—à —Å–∞–π—Ç: {website_url}\n\n–í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–µ—Ç–∏—Ç—å –Ω–∞—à —Å–∞–π—Ç, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ!")


# Sepet fonksiyonu
async def cart(update: Update, context: CallbackContext) -> None:
    cart_message = (
        "üóë –ö–æ—Ä–∑–∏–Ω–∞:\n\n"
        "–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤–∞—à–∏ –∑–∞–∫–∞–∑—ã. –ü–æ–∫–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞."
    )
    await update.message.reply_text(cart_message)


# Komandalarƒ±n v…ô mesajlarƒ±n idar…ô edilm…ôsi
def main() -> None:
    application = Application.builder().token(TOKEN).build()

    # Komandalarƒ±n qeydiyyatƒ±
    application.add_handler(CommandHandler("start", start))
    application.add_handler(MessageHandler(filters.Regex('^üç£–ú–µ–Ω—é$'), menu))
    application.add_handler(MessageHandler(filters.Regex('^üí¨ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è$'), info))
    application.add_handler(MessageHandler(filters.Regex('^üìû–ö–æ–Ω—Ç–∞–∫—Ç—ã$'), contact_info))
    application.add_handler(MessageHandler(filters.Regex('^üéâ–ê–∫—Ü–∏–∏$'), discounts))
    application.add_handler(MessageHandler(filters.Regex('^üë©‚Äçüíª–í–µ–±-—Å–∞–π—Ç$'), website))
    application.add_handler(MessageHandler(filters.Regex('^üóë–ö–æ—Ä–∑–∏–Ω–∞$'), cart))

    # Callback handler for inline buttons
    application.add_handler(CallbackQueryHandler(button))

    # Botun i≈ü…ô salƒ±nmasƒ±
    application.run_polling()


if __name__ == "__main__":
    main()
